\ProvidesPackage{FooterHeader}
\RequirePackage{kvoptions}


\DeclareStringOption[]{documentSubject}[]
\DeclareStringOption[]{documentRef}[]
\DeclareStringOption[]{documentRevision}[]
\DeclareStringOption[]{documentVersion}[]
\DeclareStringOption[]{teamName}[]
\DeclareStringOption[logoTeam.png]{logoTeam}[]
\DeclareStringOption[logoClient.png]{logoClient}[]
\DeclareStringOption[logoEseo.png]{logoEseo}[]

\ProcessKeyvalOptions*

\usepackage{fancyhdr}


%-----------------------------------------------
%   Settings for header and footer
%-----------------------------------------------

\definecolor{thorkelBlue}{RGB}{0, 0, 60}

\makeatletter

\graphicspath{{figures/}}

\pagestyle{fancy}
\fancyhf{} % clear all fields

% header
\fancyhead[LO]{\includegraphics[height=15pt]{\FooterHeader@logoTeam}
\includegraphics[height=13pt]{\FooterHeader@logoEseo}}

\renewcommand{\headrulewidth}{1pt}
\fancyhead[CO]{\FooterHeader@documentSubject}
\fancyhead[RO]{Réf. \FooterHeader@documentRef}
\def\headrule{{\if@fancyplain\let\headrulewidth\plainheadrulewidth\fi
            \color{thorkelBlue}\hrule\@height\headrulewidth\@width\headwidth \vskip-\headrulewidth}}

% footer
\ifx\FooterHeader@documentVersion\empty
\else
    \fancyfoot[LO]{Version {\FooterHeader@documentVersion} \textbf{--} Révision \FooterHeader@documentRevision}
\fi

\fancyfoot[CO]{©2023 Droits réservés, \FooterHeader@teamName}

\renewcommand{\footrulewidth}{1pt}
\fancyfoot[RO]{Page \thepage /\pageref*{LastPage}}
\def\footrule{{\if@fancyplain\let\footrulewidth\plainfootrulewidth\fi
            \vskip-\footruleskip\vskip-\footrulewidth
            \color{thorkelBlue}\hrule\@width\headwidth\@height\footrulewidth\vskip\footruleskip}}

\makeatother
